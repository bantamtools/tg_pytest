################################################################################
#
#   probing-001.json
#
# MACHINE SETUP
#   Prior to running this file:
#     Verify a probing input has been configured - typically Zmin
#     Verify a probe tool is inserted, and a probe surface is present
#     Position X,Y in the center of travel (will become (0,0))
#     XY must have > 25mm clearance in the positive direction
#     Position Z probe tip ~30mm above the probe contact surface (will become z=0)
#     This position will be set (0,0,0) by setup-centered's G28.3 command
#     Probes from the following positions should contact the probe surface:
#       (0,0,0)
#       (25,25,0)
#
# TEST SETUP
#   Selects:
#     mm mode (G21)
#     absolute distance mode (G90)
#     units-per-minute feerate mode (G94)
#
#   Sets centered point to be (0,0,0) in G55 coordinate system
#   Selects G55 coordinate system
#   Record current position as G28 home
#   Set feed rate for tests
#   (Uses 100 ms delay to allow G10 persistence for Xmega)
{
  "before_all_tests":{
    "label":"Setup for probe tests",
    "send":["G21 G90 G94",
            "G10 L20 P2 X0 Y0 Z0",
            "G55",
            "G28.1",
            "F2000"
            ],
    "fail":"hard"}
}
#
{
  "before_each_test":{
    "label":"Clear alarms and return to home",
    "send":["{clear:n}","G28"]
  }
}
#
# PROBE TESTS START HERE
#
{
  "t":{"label":"PROBE TEST - succeeds",
       "send":["G38.2 F400 Z-40"]},
  "r":{"status":0}
}
#
{
  "t":{"label":"PROBE TEST - fails to contact",
       "send":["G38.2 F400 Z-20"]},
  "r":{"status":0}
}
#
{
  "t":{"label":"PROBE TEST - missing feed rate",
       "send":["G38.2 Z-40"]},
  "r":{"status":142}
}
#
{
  "t":{"label":"PROBE TEST - zero feed rate",
       "send":["G38.2 F0 Z-40"]},
  "r":{"status":142}
}
#
{
  "t":{"label":"PROBE TEST - travel too short",
       "send":["G38.2 F400 Z-0.250"]},
  "r":{"status":251}
}
#
{
  "t":{"label":"Return to home",
    	 "send":["G28"]},
  "r":{"status":0}
}
# EOF
{
    "t":{"label":"CW 90 degree arc",
         "send":["G28","G2 I25 X125 Y125"]},
    "sr":{"posx": 125, "posy": 125},
    "r":{"status":0}
}
#
{
    "t":{"label":"CW 180 degree arc",
         "send":["G28","G2 I25 X150"]},
    "sr":{"posx": 150, "posy": 100},
    "r":{"status":0}
}
#
{
    "t":{"label":"CW 270 degree arc",
         "send":["G28","G2 I25 X125 Y75"]},
    "sr":{"posx": 125, "posy": 75},
    "r":{"status":0}
}
#
{
    "t":{"label":"CW 360 degree circle - full circle spec",
         "send":["G28","G2 I25"]},
    "sr":{"posx": 100, "posy": 100},
    "r":{"status":0}
}
#
{
    "t":{"label":"CW 540 degree circle - 1.5 rotations",
         "send":["G28","G2 I25 X150 P1"]},
    "sr":{"posx": 150, "posy": 100},
    "r":{"status":0}
}
#
{
    "t":{"label":"CW 720 degree circle - 2 rotations",
       	 "send":["G28","G2 I25 P2"]},
    "sr":{"posx": 100, "posy": 100},
    "r":{"status":0}
}
#
{
    "t":{"label":"CW 720 degree helix - 2 rotations w/Z rise",
       	 "send":["G28","G2 I25 Z25 P2"]},
    "sr":{"posx": 100, "posy": 100, "posz": 25},
    "r":{"status":0}
}
#
{
    "t":{"label":"CCW 90 degree arc",
      	 "send":["G28","G3 I25 X125 Y75"]},
    "sr":{"posx": 125, "posy": 75},
    "r":{"status":0}
}
#
{
    "t":{"label":"CCW 180 degree arc",
      	 "send":["G28","G3 I25 X150"]},
    "sr":{"posx": 150, "posy": 100},
    "r":{"status":0}
}
#
{
    "t":{"label":"CCW 360 degree circle - tests full circle specification",
      	 "send":["G28","G3 I25"]},
    "sr":{"posx": 100, "posy": 100},
    "r":{"status":0}
}
#
{
    "t":{"label":"CCW 540 degree circle - 1.5 rotations",
      	 "send":["G28","G3 I25 X150 P1"]},
    "sr":{"posx": 150, "posy": 100},
    "r":{"status":0}
}
#
{
    "t":{"label":"CCW 720 degree circle - 2 rotations",
      	 "send":["G28","G3 I25 P2"]},
    "sr":{"posx": 100, "posy": 100},
    "r":{"status":0}
}
#
{
    "t":{"label":"CCW 720 degree helix - 2 rotations w/Z rise",
      	 "send":["G28","G3 I25 Z25 P2"]},
    "sr":{"posx": 100, "posy": 100, "posz": 25},
    "r":{"status":0}
}
#
{
    "t":{"label":"Return to home",
      	 "send":["G28"]},
         "sr":{"posx": 100, "posy": 100, "posz": 0},
         "r":{"status":0}
}

{
    "t":{"label":"Setup for probe tests",
         "send":["G21 G90 G94",
                 "G10 L20 P2 X0 Y0 Z0",
                 "G55",
                 "G28.1",
                 "F2000"
                 ],
         "fail":"hard"},
    "r":{"status":0}
}
