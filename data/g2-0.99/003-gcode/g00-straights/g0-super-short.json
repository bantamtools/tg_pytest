################################################################################
#
#   g0-super-short.json - tests for lines right on the edge of unplannable
#
# MACHINE SETUP
#   These tests are best run on a fast XY belt machine like a Shapeoko,
#   Ultimaker or a Makeblock. Maximums tested:
#       X and Y maximum velocity        40,000 mm/min
#       X and Y maximum jerk            20,000 mm/min^3 (* 1,000,000)
#       JT junction integration time    2.0
#
#   Position the machine in the center of travel in X, Y and Z
#   Clearance must be at least 100mm positive and negative in each dimension.
#   This position will be set (0,0,0) by setup-centered's G28.3 command
#
##################
### TEST SETUP ###
##################
#
{
  "before_all":{
    "label":"Setup for straights tests",
    "fail":"hard",
    "before":["{clear:n}","{ej:1}", "{jv:5}", "{tv:1}", "{qv:0}", "{sv:1}", "{si:200}",
            "{ct:0.1}","{jt:2.0}",
            "{xvm:40000}","{xjm:20000}",
            "{yvm:40000}","{yjm:20000}",
            "G17 G21 G90 G91.1 G94",
            "G28.3 X0 Y0",
            "G28.1",
            "F2000"
            ]
  }
}
#
{
  "before_each":{
    "label":"Return to home",
    "before":["{clear:n}","G28"]
  }
}
#
{
  "after_all":{
    "label":"Return to home",
    "after":["{clear:n}","G28"]
  }
}
#
# TESTS START HERE
#
# Basic test
#
{
    "t":{"label":"Traverse 0.1 mm",
        "send":["G0 X0.1",
                "G0 X0.0"]},
    "sr":{"posx": 0, "stat":3},
    "r":{"status":0}
}
#
{
    "t":{"label":"Feed 0.1 mm",
        "send":["G1 F1000 X0.1",
                "G1 F1000 X0.0"]},
    "sr":{"posx": 0, "stat":3},
    "r":{"status":0}
}
#
# Zero length move tests
#
{
    "t":{"label":"Traverse 0.1 mm, then zero length move",
        "send":["G0 X0",
                "G0 X0.1",
                "G0 X0.1"]},
    "sr":{"posx": 0.1, "stat":3},
    "r":{"status":0}
}
#
{
    "t":{"label":"Feed 0.1 mm, then zero length move",
        "send":["G1 F1000 X0",
                "G1 F1000 X0.1",
                "G1 F1000 X0.1"]},
    "sr":{"posx": 0.1, "stat":3},
    "r":{"status":0}
}
#
{
    "t":{"label":"Traverse 0.1 mm, then multiple zero length moves",
        "send":["G0 X0",
                "G0 X0.1",
                "G0 X0.1",
                "G0 X0.1",
                "G0 X0.1"]},
    "sr":{"posx": 0.1, "stat":3},
    "r":{"status":0}
}
#
{
    "t":{"label":"Traverse 0.1 mm, then multiple zero length moves",
        "send":["G1 F1000 X0",
                "G1 F1000 X0.1",
                "G1 F1000 X0.1",
                "G1 F1000 X0.1",
                "G1 F1000 X0.1"]},
    "sr":{"posx": 0.1, "stat":3},
    "r":{"status":0}
}
#
# Ever shorter traverses
#
{
    "t":{"label":"Traverse 0.01 mm",
        "before":["G0 X0"],
        "send":["G0 X0.01"],
        "after":["G0 X0"]},
    "sr":{"posx": 0.01, "stat":3},
    "r":{"status":0}
}
#
{
    "t":{"label":"Traverse 0.001 mm",
        "before":["G0 X0"],
        "send":["G0 X0.001"],
        "after":["G0 X0"]},
    "sr":{"posx": 0.001, "stat":3},
    "r":{"status":0}
}
#
{
    "t":{"label":"Traverse 0.0001 mm",
        "before":["G0 X0"],
        "send":["G0 X0.0001"],
        "after":["G0 X0"]},
    "sr":{"posx": 0.0001, "stat":3},
    "r":{"status":0}
}
#
{
    "t":{"label":"Traverse 0.00001 mm",
        "before":["G0 X0"],
        "send":["G0 X0.00001"],
        "after":["G0 X0"]},
    "sr":{"posx": 0.00001, "stat":3},
    "r":{"status":0}
}
# This one returns as 10.00000 due to display truncation to 5 digits
{
    "t":{"label":"Traverse 0.000001 mm",
        "before":["G0 X0"],
        "send":["G0 X10",
                "G0 X10.000001"],
        "after":["G0 X0"]},
    "sr":{"posx": 10, "stat":3},
    "r":{"status":0}
}
#
{
    "t":{"label":"Traverse 0.00000133514404 mm",
        "before":["G0 X0"],
        "send":["G0 X0.0000133514404"],
        "after":["G0 X0"]},
    "sr":{"posx": 10, "stat":3},
    "r":{"status":0}
}

# EOF
{
    "t":{"label":"Straight traverse to x100 y100",
         "send":["G0 X100 Y100"]},
    "sr":{"posx": 100, "posy": 100, "stat":3},
    "r":{"status":0}
}
#
{
    "t":{"label":"Straight traverse and return",
         "send":["G0 X100 Y100", "G0 X0 Y0"]},
    "sr":{"posx": 0, "posy": 0, "stat":3},
    "r":{"status":0}
}
#
{
    "t":{"label":"Straight traverse to same location (zero length move)",
        "before":["G0 X0 Y0"],
        "send":["G0 X0 Y0"]},
    "sr":{"posx": 0, "posy": 0, "stat":3},
    "r":{"status":0}
}
#
# Simple Feeds
{
    "t":{"label":"Straight feed to x100",
         "send":["G1 X100 F5000"]},
    "sr":{"posx": 100, "posy": 0},
    "r":{"status":0}
}
#
{
    "t":{"label":"Straight feed to x100 y100",
         "before":["G28"],
         "send":["G1 X100 Y100 F8000"]},
    "sr":{"posx": 100, "posy": 100},
    "r":{"status":0}
}
#
{
    "t":{"label":"Straight feed and return at different rates",
         "send":["G1 X100 Y100 F10000", "G1 X0 Y0 F3000"]},
    "sr":{"posx": 0, "posy": 0},
    "r":{"status":0}
}
#
{
    "t":{"label":"Straight feed at F100",
         "send":["G1 X10 Y10 F100"]},
    "sr":{"posx": 10, "posy": 10},
    "r":{"status":0}
}
#
{
    "t":{"label":"Straight feed at F10",
         "send":["G1 X2 Y2 F10"]},
    "sr":{"posx": 2, "posy": 2},
    "r":{"status":0}
}
#
{
    "t":{"label":"Straight feed at F1",
         "send":["G1 X0.2 Y0.2 F1"]},
    "sr":{"posx": 0.2, "posy": 0.2},
    "r":{"status":0}
}
#
{
    "t":{"label":"Straight feed to same location (zero length move)",
        "before":["G0 X0 Y0"],
        "send":["G1 X0 Y0 F1000"]},
    "sr":{"posx": 0, "posy": 0, "stat":3},
    "r":{"status":0}
}
#
# Mixed Feeds
{
    "t":{"label":"Mixed G1 feed to x100 - 2 segments",
         "send":["F5000","G1 X50","X100"]},
    "sr":{"posx": 100, "posy": 0},
    "r":{"status":0}
}
#
{
    "t":{"label":"Mixed G1 feed to x100 - 5 segments at different rates",
         "send":["F2000","G1 X20","F4000 X40","F8000 X60","F3000 X80","F1000 X100"]},
    "sr":{"posx": 100, "posy": 0},
    "r":{"status":0}
}
#
{
    "t":{"label":"Mixed G1/G0 feeds to x100 - 5 segments at different rates",
         "send":["F2000","G1 X20","G0 X40","G1 X60 F1000","G0 X80","G1 F1000 X100"]},
    "sr":{"posx": 100, "posy": 0},
    "r":{"status":0}
}
# Gcode wrapped in JSON
#
{
    "t":{"label":"JSON wrapped gcode",
         "send":["{gc:\"G0 X100\"}"]},
    "sr":{"posx": 100, "posy": 0, "stat":3},
    "r":{"status":0}
}
