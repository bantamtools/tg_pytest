################################################################################
#
#   init-gcode.json - common initialization for gcode tests
#
# DEFAULTS
{
  "defaults":{
    "fail":"hard",
    "delay":0.100,
    "precision":0.00001
  }
}
# BEFORE AND AFTERS
{
  "before_all":{
    "label":"Reset default settings - Always run this one by itself",
    "after":["{defa:t}"]
  }
}
#
{
  "before_each":{
    "label":"clear alarms",
    "before":["{clear:n}"],
    "delay":0.100
  }
}
#
{
  "after_all":{
    "label":"M30 program end - also clears alarms",
    "after":["M30"]
  }
}
# SETUP ROUTINES
{
    "t":{"label":"Set baseline configs",
        "send":["{ej:1}", "{jv:5}", "{tv:1}", "{qv:0}", "{sv:2}", "{si:200}"],
        "delay":0.100},
    "r":{"status":0}
}
# SKIP - SRS not yet implemented
{
    "t":{"label":"Clear status report - THIS FUNCTION SHOULD ALWAYS RUN BY ITSELF",
        "send":["{srs:{clear:t}}"]},
    "r":{"status":0}
}
# SKIP - SRS not yet implemented
{
    "t":{"label":"Set status report - RUNS AFTER CLEAR STATUS REPORT",
        "send":["{srs:{set:{line:t,posx:t,posy:t,posz:t,posa:t,feed:t,vel:t,unit:t,coor:t,dist:t,stat:t}}}"]},
    "r":{"status":0}
}
# Use old-style status report setup line
{
    "t":{"label":"Set status report - RUNS AFTER CLEAR STATUS REPORT",
        "send":["{sr:{line:t,posx:t,posy:t,posz:t,posa:t,feed:t,vel:t,unit:t,coor:t,dist:t,stat:t}}"]},
    "r":{"status":0}
}
#
{
    "t":{"label":"Set gcode defaults - clear coordinate offsets",
        "send":["{ct:0.1}","{jt:2.0}","{sl:t}",
                "G21 G17 G49 G80 G90 G91.1 G94",
                "G10 L2 P1 X0 Y0 Z0",
                "G10 L2 P2 X0 Y0 Z0",
                "G10 L2 P3 X0 Y0 Z0",
                "G10 L2 P4 X0 Y0 Z0",
                "G10 L2 P5 X0 Y0 Z0",
                "G10 L2 P6 X0 Y0 Z0",
                "G54"
               ]},
    "r":{"status":0}
}
#
{
    "t":{"label":"Set current point as machine origin (0,0,0)",
        "send":["g28.3 x0 y0 z0 a0"]},
    "r":{"status":0}
}
# SKIP
{
    "t":{"label":"Home machine to limit switches",
        "send":["g28.2 x0 y0 z0"],
        "setup":true},
    "r":{"status":0}
}
#
{
    "t":{"label":"Set origin as (-40,-40,20) in G55",
        "send":["G10 L20 P2 X-40 Y-40 Z20"]},
    "r":{"status":0}
}
#
{
    "t":{"label":"Set origin as (-20,-20,10) in G56",
        "send":["G10 L20 P3 X-20 Y-20 Z10"]},
    "r":{"status":0}
}
