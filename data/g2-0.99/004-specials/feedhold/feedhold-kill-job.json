################################################################################
#
#   feedhold-kill-job.json - feedhold tests for ^D kill job
#
#   See feedhold-init file for machine setup instructions
#
# include 004-specials/feedhold/feedhold-init.json
#
# DEFAULTS
{
    "defaults":{
        "fail":"hard",
        "fail_returned_er":false,
        "fail_missing_sr":false,
        "delay":0.100,
        "precision":0.001
    }
}
#
{
    "after_all":{
        "label":"Reset default settings & cancel cycles",
        "after":["{clear:n}"]
    }
}
#
# TESTS START HERE
#
# Run a feedhold then kill job
{
    "t":{"label":"FKJ1A: Single move test to 30 - start movement and do a feedhold",
        "before":["{clear:n}", "g0 x0 y0"],
        "send":["m3 m7 m8",
                "N10 G1 F500 X30", "!"],
        "delay":0.5},
    "r":{"status":0},
    "sr":{"stat":6,"com":3,"cof":3,"spc":3}
}
#
{
    "t":{"label":"FKJ1B: Kill job from within from feedhold",
        "send":["\u0004"]},
    "r":{"status":0},
    "sr":{"stat":2,"com":3,"cof":3,"spc":3}
}
#
# Clear the alram then do it again. Run a feedhold then kill job
{
    "t":{"label":"FKJ2A: Single move test to 30 - start movement and do a feedhold",
        "before":["{clear:n}", "g0 x0 y0"],
        "send":["m3 m7 m8",
                "N20 G1 F500 X30", "!"],
        "delay":0.75},
    "r":{"status":0},
    "sr":{"stat":6,"com":3,"cof":3,"spc":3}
}
#
{
    "t":{"label":"FKJ2B: Kill job from within from feedhold",
        "send":["\u0004"]},
    "r":{"status":0},
    "sr":{"stat":2,"com":3,"cof":3,"spc":3}
}
